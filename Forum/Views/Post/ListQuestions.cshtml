@model List<Forum.Models.Post>
@using Microsoft.AspNet.Identity
@{
    ViewBag.Title = "ListQuestions";
}

<div class="container">
    <div class="well" style="border-style:solid">
        <h2>Topics</h2>

        <table class="table table-striped table-hover">
            <thead>
                
                <tr>
                    <th></th>
                    <th>Title</th>
                    <th>Author Name</th>
                    <th>Author Picture</th>
                </tr>
            </thead>

            <tbody>
                
                <tr>
                    <td>
                        @Html.ActionLink("New Topic", "CreatePost", "Post", new { @categoryid = ViewBag.categoryId }, new { @class = "btn btn-warning" })
                    </td>
                    
                    <td></td>
                    <td></td>
                    
                    <td align="right">
                        <ul class="pagination">
                            @{
                                int prevPage = 0;
                                List<int> pagingList = ViewBag.pagingElems;

                            }

                            @for (int i = 0; i < pagingList.Count(); i++)
                            {
                                prevPage = pagingList[i];

                                <li>
                                    @Html.ActionLink(pagingList[i].ToString(), "ListQuestions", "Post", new { @categoryId = ViewBag.categoryId, @page = pagingList[i] }, null)
                                </li>


                                if (i < pagingList.Count() - 1 && pagingList[i + 1] != pagingList[i] + 1)
                                {
                                    <li>@Html.ActionLink("...", "Index", "Home") </li>

                                }


                            }
                        </ul>

                    </td>

                </tr>



                @foreach (var question in Model)
                {
                    @:
                    <tr>
                        <td align="center"><img  src="~/Content/images/topic.png"/></td>
                        <td>@Html.ActionLink(question.Title, "ListAnswers", "Post", new { @id = question.PostId, @page=1 }, null)</td>
                        <td>@Html.ActionLink(question.Author.FullName, "Details", "Account", new { @id = question.Author.Id }, null)</td>
                        
                        <td>                      
                            

                              
                            @{var imgUrl = Url.Content("~/Content/images/profile/" + question.Author.UserName + ".png") + "?time=" + DateTime.Now.ToString(); }
                              
                            <object data="@imgUrl"  type="image/png"  height="30" width="30">
                                <img src="~/Content/images/Smiley.svg.png" height="30" width="30" />
                            </object>

                               
                            
                       </td>
                        @if (User.IsInRole("Admin") || question.isAuthor(User.Identity.Name))
                        {
                        <td>@Html.ActionLink("Edit", "Edit", "Post", new { @id = question.PostId }, new { @class = "btn btn-success btn-xs" })</td>
                        <td>@Html.ActionLink("Delete", "Delete", "Post", new { @id = question.PostId }, new { @class = "btn btn-danger btn-xs" })</td>
                        }
                    </tr>
                }

            </tbody>
        </table>
    </div>
</div>